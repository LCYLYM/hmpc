# 使用指南

## 安装要求

### 系统要求
- Android 5.0 (API 21) 或更高版本
- 推荐 Android 10+ 以获得最佳兼容性
- 至少 50MB 可用存储空间

### 设备要求
- 支持 PC 模式/桌面模式的平板设备
- 如:三星 Galaxy Tab、华为 MatePad、小米平板等

## 安装步骤

### 方法 1: 从源代码构建

1. **克隆仓库**
```bash
git clone https://github.com/yourusername/pc-mode-activator.git
cd pc-mode-activator
```

2. **打开项目**
- 使用 Android Studio 打开 `android-app` 目录
- 等待 Gradle 同步完成

3. **连接设备**
- 启用开发者选项和 USB 调试
- 通过 USB 连接平板到电脑

4. **运行应用**
- 点击 Android Studio 的"运行"按钮
- 或使用命令: `./gradlew installDebug`

### 方法 2: 安装 APK (待发布)

1. 下载最新版本的 APK 文件
2. 在平板上启用"允许安装未知来源应用"
3. 打开 APK 文件进行安装
4. 授予必要的权限

## 使用说明

### 首次使用

1. **启动应用**
   - 在应用列表中找到"PC 模式激活器"
   - 点击图标启动应用

2. **激活 PC 模式**
   - 点击"激活 PC 模式"按钮
   - 系统会弹出屏幕录制权限请求
   - 点击"立即开始"授予权限

3. **确认激活**
   - 应用会显示"PC 模式已激活"
   - 通知栏会显示"虚拟显示器正在运行"
   - 观察设备是否进入 PC 模式

4. **停用 PC 模式**
   - 点击"停用 PC 模式"按钮
   - 或在通知栏停止服务

### 权限说明

应用需要以下权限:

| 权限 | 用途 | 必需性 |
|------|------|--------|
| 屏幕录制 (MediaProjection) | 创建虚拟显示器 | 必需 |
| 前台服务 | 保持服务运行 | 必需 |
| 通知 | 显示服务状态 | 必需 |

⚠️ **注意**: 屏幕录制权限需要每次启动时重新授予

### 界面说明

```
┌─────────────────────────────┐
│      [应用图标]              │
│                             │
│   PC 模式激活器              │
│                             │
│   通过创建虚拟显示器来       │
│   激活平板的 PC 模式         │
│                             │
│   状态: 未激活               │
│                             │
│  ┌─────────────────────┐   │
│  │  激活 PC 模式        │   │
│  └─────────────────────┘   │
│                             │
│  ┌─────────────────────┐   │
│  │  停用 PC 模式        │   │
│  └─────────────────────┘   │
│                             │
│   注意: 此功能需要授予       │
│   屏幕录制权限...            │
└─────────────────────────────┘
```

## 常见使用场景

### 场景 1: 日常使用
- 每天早上启动应用激活 PC 模式
- 使用平板进行办公
- 晚上停用以节省电量

### 场景 2: 外出携带
- 无需携带显示器或适配器
- 随时激活 PC 模式
- 配合蓝牙键鼠使用

### 场景 3: 临时需求
- 快速切换到 PC 模式
- 处理文档或演示
- 完成后立即停用

## 疑难解答

### 问题 1: 权限授予后应用崩溃
**可能原因**: 设备不支持虚拟显示器
**解决方法**:
- 检查 Android 版本(需要 5.0+)
- 查看日志: `adb logcat | grep VirtualDisplay`
- 尝试重启设备

### 问题 2: PC 模式未激活
**可能原因**: 设备不支持通过虚拟显示器触发
**解决方法**:
- 确认设备支持 PC 模式
- 尝试连接真实显示器确认功能可用
- 查看技术分析文档的兼容性说明
- 考虑使用硬件方案(HDMI 假负载)

### 问题 3: 通知无法关闭
**原因**: Android 要求前台服务必须显示通知
**解决方法**: 这是正常现象,无法关闭

### 问题 4: 电池消耗快
**可能原因**: 虚拟显示器持续运行
**解决方法**:
- 不使用时及时停用
- 应用已优化为最低资源占用
- 考虑在充电时使用

### 问题 5: 与其他投屏应用冲突
**可能原因**: MediaProjection 权限独占
**解决方法**:
- 停用本应用再使用其他投屏应用
- 或停用其他投屏应用

### 问题 6: 重启后需要重新授权
**原因**: MediaProjection 权限不持久化
**解决方法**: 这是 Android 安全机制,无法绕过

## 高级使用

### 自动启动 (需要额外配置)

1. 使用 Tasker 或 MacroDroid 自动化工具
2. 创建开机启动任务
3. 自动打开应用并模拟点击

### 自定义虚拟显示器参数

编辑 `VirtualDisplayService.kt`:

```kotlin
// 修改分辨率
private const val VIRTUAL_DISPLAY_WIDTH = 2560   // 1440p
private const val VIRTUAL_DISPLAY_HEIGHT = 1440
private const val VIRTUAL_DISPLAY_DPI = 240

// 或使用 720p 节省资源
private const val VIRTUAL_DISPLAY_WIDTH = 1280
private const val VIRTUAL_DISPLAY_HEIGHT = 720
private const val VIRTUAL_DISPLAY_DPI = 160
```

### 查看日志

使用 ADB 查看详细日志:

```bash
# 查看虚拟显示器日志
adb logcat | grep VirtualDisplayService

# 查看显示管理器日志
adb logcat | grep DisplayManager

# 查看完整日志
adb logcat > log.txt
```

## 性能优化建议

### 降低资源占用
1. 使用 720p 而不是 1080p
2. 及时停用不使用的功能
3. 避免长时间运行

### 延长电池寿命
1. 充电时使用
2. 降低虚拟显示器分辨率
3. 使用完毕立即停用

### 提升稳定性
1. 定期重启应用
2. 避免同时运行多个投屏应用
3. 保持系统更新

## 反馈与支持

### 报告问题
在 GitHub Issues 提交问题时,请提供:
- 设备型号和 Android 版本
- 详细的问题描述
- 日志文件(如果可能)
- 复现步骤

### 功能建议
欢迎在 Issues 中提出功能建议

### 贡献代码
欢迎提交 Pull Request

## 免责声明

- 本应用仅用于技术研究和学习
- 不保证在所有设备上都能激活 PC 模式
- 使用本应用产生的任何后果由使用者承担
- 建议先在非主力设备上测试

## 隐私说明

本应用:
- ✅ 不收集任何用户数据
- ✅ 不上传任何信息到服务器
- ✅ 不包含任何广告
- ✅ 完全开源,代码可审查

屏幕录制权限仅用于创建虚拟显示器,不会实际录制或保存屏幕内容。
